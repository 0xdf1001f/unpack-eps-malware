#Pyhton 3 for unpack eps malware code
import zlib
import sys
import argparse

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='This is a script to extract EPS')
    parser.add_argument('--input','-i',help='input file')
    parser.add_argument('--output','-o',help='output file')
    args = parser.parse_args()

    input_file = None
    output_file = None
    if args.input:
        input_file = args.input
    if args.output:
        output_file = args.output

    if input_file is None:
        parser.print_help()
        sys.exit(-1)

    data = ''
    with open(input_file,"rb") as f:
        data = f.read()

    try:
        data = zlib.decompress(data,wbits=-15)
    except Exception as e:
        print(e.args)
        sys.exit(-3)

    if output_file is None:
        print(data)
    else:
        with open(output_file,"wb") as f:
            f.write(data)
            print('extract the eps file to'+ooutput_file+'susscessful.\n')
